<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>iSkin尚行美健康聯合診所 管理後台登入</title>
  <link rel="stylesheet" href="../css/site.css">
</head>
<body class="scroll">
  <div class="admin-wrap">
    <div class="side-bar">
        <div class="side-bar__logo">
          <img src="../images/admin-logo.jpg" alt="">
        </div>
        <div class="side-bar__nav">
          <ul>
            <li>
              <a class="side-bar__btn side-bar__btn--sub" href="#">員工管理</a>
              <div class="side-bar__sub-nav">
                <a href="employee-list.html">員工管理</a>
                <a href="vacation-management.html">休假管理</a>
                <a href="employee-substitue.html">代班管理</a>
                <a href="employee-extra.html">加診管理</a>
              </div>
            </li>
            <li>
              <a class="side-bar__btn side-bar__btn--sub" href="#">服務管理</a>
              <div class="side-bar__sub-nav">
                <a href="service-type-list.html">類別管理</a>
                <a href="service-course-list.html">療程管理</a>
                <a href="service-group-add.html">群組管理</a>
                <a href="service-flow-list.html">流程管理</a>
                <a href="service-step.html">步驟總表</a>
                <a href="service-special.html">醫療特例管理</a>
              </div>
            </li>
            <li>
              <a class="side-bar__btn" href="office-list.html">診間管理</a>
            </li>
            <li>
              <a class="side-bar__btn side-bar__btn--sub" href="#">器材管理</a>
              <div class="side-bar__sub-nav">
                <a href="equipment-type.html">類別管理</a>
                <a href="equipment-equip.html">器材管理</a>
              </div>
            </li>
            <li>
              <a class="side-bar__btn" href="client-list.html">客戶管理</a>
            </li>
            <li>
              <a class="side-bar__btn" href="account-list.html">帳號管理</a>
            </li>
            <li>
              <a class="side-bar__btn side-bar__btn--sub" href="#">其它管理</a>
              <div class="side-bar__sub-nav">
                <a href="">診所時間</a>
                <a href="other-announce.html">佈告管理</a>
                <a href="other-message.html">簡訊管理</a>
                <a href="backup-and-return.html">備份與回復</a>
              </div>
            </li>
            <li>
              <a class="side-bar__btn" href="overall-report.html">總體報表</a>
            </li>
            <li>
              <a class="side-bar__btn side-bar__btn--sub is-active" href="">明細查詢</a>
              <div class="side-bar__sub-nav">
                <a href="work-detail-reserve.html">預約紀錄</a>
                <a href="work-detail-assign.html">指派紀錄</a>
                <a href="work-detail.html">工作紀錄</a>
                <a href="">諮詢成交紀錄</a>
              </div>
            </li>
          </ul>
        </div>
        <button class="side-bar__btn-logout">登出</button>
      </div>
    <div class="admin-main">
      <div class="admin-header">
        <h2>諮詢成交紀錄</h2>
        <div class="admin-header__control">
          <div class="admin-header__account">
            <img class="admin-header__account-avatar" class="" src="https://picsum.photos/id/1005/120/120" alt="">
            <span class="admin-header__account-name">司徒法寶</span>
            <button class="admin-header__btn-logout">登出</button>
          </div>
        </div>
      </div>
      <div class="work-detail">
        <div class="work-detail__date-picker">
          <input type="date" value="2021-01-01">～<input type="date" value="2021-01-31">
        </div>
        <div class="work-detail__filter">
            <div class="work-detail__select-wrap result">
              <select name="type" id="type">
                <option value="0">員工</option>
                <option value="1">預約</option>
                <option value="2">取消</option>
                <option value="3">改期</option>
                <option value="4">硬約</option>
              </select>
            </div>
            <div class="work-detail__select-wrap result">
              <select name="type" id="type">
                <option value="0">療程類別</option>
                <option value="1">預約</option>
                <option value="2">取消</option>
                <option value="3">改期</option>
                <option value="4">硬約</option>
              </select>
            </div>
            <div class="work-detail__select-wrap result">
              <select name="type" id="type">
                <option value="0">療程</option>
                <option value="1">預約</option>
                <option value="2">取消</option>
                <option value="3">改期</option>
                <option value="4">硬約</option>
              </select>
            </div>
        </div>
        <div class="work-detail__report">
          <p class="work-detail__total">案件總數：758</p>
          <button class="admin-btn-add work-detail__export">匯出報表</button>
        </div>
        <div class="work-detail__wrap">
            <div class="employee-report__report-info work-detail__deal">
                <div class="employee-report__chart">
                  <canvas id="report-chart" width="340" height="340"></canvas>
                </div>
                <div class="employee-report__work-list">
                  <p>任務總數：<strong>152</strong></p>
                  <p>準時完成數量：<strong>78</strong></p>
                  <p>逾時完成數量：<strong>62</strong></p>
                  <p>未完成數量：<strong>12</strong></p>
                </div>
            </div>
          <h3>工作明細</h3>
          <div class="work-detail__list">
            <div class="work-detail__work-item">
              <div class="work-detail__row">
                <span class="work-detail__col1_5">諮詢人員：ＳＳＳ</span>
                <span class="work-detail__col1_5">客人：ＲＲＲ   65/1/1</span>
                <span class="work-detail__col1_5">日期：2021-10-01</span>
                <span class="work-detail__col1_5">時間：19:08 ~ 19:13</span>
                <span class="work-detail__col1_5">是否成交：<span class="color-green">成交</span></span>
              </div>
              <div class="work-detail__row deal-content">
                <span class="deal-content__title">成交內容：</span>
                <ul class="deal-content__content">
                    <li>項目名稱項目名稱  x1</li>
                    <li>項目名稱項目名稱項目名稱  x120</li>
                    <li>名稱項目名稱  x50</li>
                    <li>名稱項目名稱  x50</li>
                    <li>項目名稱項目名稱  x1</li>
                    <li>項目名稱項目名稱項目名稱  x120</li>
                </ul>
              </div>
            </div>
            <div class="work-detail__work-item">
              <div class="work-detail__row">
                <span class="work-detail__col1_5">諮詢人員：ＳＳＳ</span>
                <span class="work-detail__col1_5">客人：ＲＲＲ   65/1/1</span>
                <span class="work-detail__col1_5">日期：2021-10-01</span>
                <span class="work-detail__col1_5">時間：19:08 ~ 19:13</span>
                <span class="work-detail__col1_5">是否成交：<span class="color-red">未成交</span></span>
              </div>
              <div class="work-detail__row deal-content">
                <span class="deal-content__title">成交內容：</span>
                <ul class="deal-content__content">
                    <li>項目名稱項目名稱  x1</li>
                    <li>項目名稱項目名稱項目名稱  x120</li>
                    <li>名稱項目名稱  x50</li>
                    <li>名稱項目名稱  x50</li>
                    <li>項目名稱項目名稱  x1</li>
                    <li>項目名稱項目名稱項目名稱  x120</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="admin-pagination">
            <button class="admin-pagination__btn-prev is-disable">上一頁</button>
            <span class="admin-pagination__current">1</span>
            <span class="admin-pagination__page">/ 22頁</span>
            <button class="admin-pagination__btn-next">下一頁</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script src="../js/all.js"></script>
  <script>
    $(function(){
      $('.side-bar__btn--sub').on('click', function(e){
        e.preventDefault()
        $(this).next().toggleClass('is-active')
      })

      var reportCanvas = document.getElementById("report-chart");
      var reportData = {
        datasets: [
          {
            data: [78, 62, 12],
            backgroundColor: [
              "#6088a5",
              "#e89741",
              "#afac83",
            ],
            borderWidth: 1
          }]
      };
      Chart.defaults.global.defaultFontSize = 16;
      var pieOptions = {
        events: false,
        animation: {
          duration: 500,
          easing: "easeOutQuart",
          onComplete: function () {
            var ctx = this.chart.ctx;
            ctx.font = Chart.helpers.fontString(
              Chart.defaults.global.defaultFontFamily,
              'normal'
            );
            ctx.textAlign = 'center';
            ctx.textBaseline = 'bottom';

            this.data.datasets.forEach(function (dataset) {

              for (var i = 0; i < dataset.data.length; i++) {
                var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model,
                    total = dataset._meta[Object.keys(dataset._meta)[0]].total,
                    mid_radius = model.innerRadius + (model.outerRadius - model.innerRadius)/2,
                    start_angle = model.startAngle,
                    end_angle = model.endAngle,
                    mid_angle = start_angle + (end_angle - start_angle)/2;

                var x = mid_radius * Math.cos(mid_angle);
                var y = mid_radius * Math.sin(mid_angle);

                ctx.fillStyle = '#fff';
                if (i == 3){ // Darker text color for lighter background
                  ctx.fillStyle = '#444';
                }
                var percent = String(Math.round(dataset.data[i]/total*100)) + "%";      
                //Don't Display If Legend is hide or value is 0
                if(dataset.data[i] != 0 && dataset._meta[0].data[i].hidden != true) {
                  // Display percent in another line, line break doesn't work for fillText
                  ctx.fillText(percent, model.x + x, model.y + y);
                }
              }
            });               
          }
        }
      };

      var pieChart = new Chart(reportCanvas, {
        type: 'pie',
        data: reportData,
        options: pieOptions
      });
    })
  </script>
</body>
</html>